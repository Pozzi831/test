<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Тест: Теория систем (Мгновенный результат)</title>
    <style>
        :root {
            --primary: #4a90e2;
            --secondary: #f5f7fa;
            --text: #333;
            --success: #2ecc71;
            --success-bg: #d4edda;
            --success-border: #c3e6cb;
            --error: #e74c3c;
            --error-bg: #f8d7da;
            --error-border: #f5c6cb;
            --radius: 12px;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        }

        body {
            background-color: #e9ecef;
            color: var(--text);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            background: white;
            width: 100%;
            max-width: 800px;
            border-radius: var(--radius);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            min-height: 550px;
        }

        /* Screen Management */
        .screen {
            display: none;
            padding: 20px;
            flex-grow: 1;
            flex-direction: column;
            animation: fadeIn 0.3s ease-in-out;
        }
        
        .screen.active {
            display: flex;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Header & Stats */
        .header {
            background: var(--primary);
            color: white;
            padding: 15px 20px;
            margin: -20px -20px 20px -20px;
            text-align: center;
        }

        .stats-bar {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 10px;
            font-weight: bold;
        }

        .stat-item {
            background: rgba(255, 255, 255, 0.2);
            padding: 5px 15px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .progress-container {
            background: rgba(255,255,255,0.3);
            height: 6px;
            border-radius: 3px;
            overflow: hidden;
            margin-top: 15px;
        }

        .progress-bar {
            background: #fff;
            height: 100%;
            width: 0%;
            transition: width 0.3s ease;
        }

        /* Question Content */
        .question-text {
            font-size: 1.2rem;
            margin-bottom: 20px;
            line-height: 1.5;
            font-weight: 600;
        }

        .options-grid {
            display: grid;
            gap: 12px;
            margin-bottom: 20px;
        }

        .option-btn {
            background: var(--secondary);
            border: 2px solid transparent;
            padding: 16px;
            border-radius: 8px;
            text-align: left;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.2s;
            color: var(--text);
            width: 100%;
            position: relative;
        }

        .option-btn:hover:not(.disabled) {
            background: #e2e6ea;
        }

        /* Styles for Correct/Wrong answers */
        .option-btn.correct {
            background-color: var(--success-bg);
            border-color: var(--success);
            color: #155724;
        }

        .option-btn.wrong {
            background-color: var(--error-bg);
            border-color: var(--error);
            color: #721c24;
        }

        .option-btn.disabled {
            cursor: default;
            opacity: 0.8;
        }

        /* Footer */
        .footer {
            margin-top: auto;
            border-top: 1px solid #eee;
            padding-top: 20px;
            display: flex;
            justify-content: flex-end;
        }

        .btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 14px 35px;
            border-radius: 8px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: opacity 0.2s;
            font-weight: bold;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: #ccc;
        }

        /* Results */
        #results-screen {
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        .score-circle {
            width: 160px;
            height: 160px;
            border-radius: 50%;
            border: 8px solid var(--primary);
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0 auto 30px;
            font-size: 3rem;
            font-weight: bold;
            color: var(--primary);
        }

        .grade-badge {
            padding: 10px 25px;
            border-radius: 30px;
            font-size: 1.5rem;
            font-weight: bold;
            color: white;
            margin-bottom: 20px;
            display: inline-block;
        }

        /* Mobile Adjustments */
        @media (max-width: 600px) {
            .container {
                border-radius: 0;
                min-height: 100vh;
            }
        }
    </style>
</head>
<body>

<div class="container">
    <div id="start-screen" class="screen active" style="justify-content: center; align-items: center; text-align: center;">
        <h1 style="margin-bottom: 20px; color: var(--primary);">Тест по Теории систем</h1>
        <p style="margin-bottom: 40px; color: #666; font-size: 1.1rem;">
            В базе 79 вопросов.<br>
            Система выберет 40 случайных вопросов.<br>
            Результат проверяется мгновенно.
        </p>
        <button class="btn" onclick="startTest()">Начать тестирование</button>
    </div>

    <div id="quiz-screen" class="screen">
        <div class="header">
            <h2 id="question-counter" style="font-size: 1.1rem;">Вопрос 1 из 40</h2>
            
            <div class="stats-bar">
                <div class="stat-item" style="color: #d4edda; background: rgba(46, 204, 113, 0.4);">
                    <span>✅</span> <span id="live-correct">0</span>
                </div>
                <div class="stat-item" style="color: #f8d7da; background: rgba(231, 76, 60, 0.4);">
                    <span>❌</span> <span id="live-wrong">0</span>
                </div>
            </div>

            <div class="progress-container">
                <div class="progress-bar" id="progress-bar"></div>
            </div>
        </div>
        
        <div class="question-text" id="question-text">Загрузка вопроса...</div>
        <div class="options-grid" id="options-container">
            </div>

        <div class="footer">
            <button class="btn" id="next-btn" onclick="nextQuestion()" disabled>След. вопрос</button>
        </div>
    </div>

    <div id="results-screen" class="screen">
        <h2 style="margin-bottom: 20px;">Тест завершен!</h2>
        <div class="score-circle" id="score-display">0%</div>
        <div id="grade-badge" class="grade-badge">Оценка</div>
        
        <div style="display: flex; justify-content: center; gap: 30px; margin-bottom: 30px;">
            <div style="color: var(--success); font-weight: bold; font-size: 1.2rem;">Верно: <span id="final-correct">0</span></div>
            <div style="color: var(--error); font-weight: bold; font-size: 1.2rem;">Ошибок: <span id="final-wrong">0</span></div>
        </div>

        <p id="feedback-text" style="color: #666; margin-bottom: 30px;"></p>
        <button class="btn" onclick="restartTest()">Пройти заново</button>
    </div>
</div>

<script>
    // === БАЗА ВОПРОСОВ ===
    const allQuestions = [
        {"question": "1. Что такое «окружающая среда»?", "options": ["а) множество элементов, которые не входят в систему и изменение их состояния никаким образом не отражается на системе;", "б) множество элементов, которое не входит в систему, но изменение их состояния влияет на поведение системы."], "correct": "б"},
        {"question": "2. Что такое входы и выходы системы?", "options": ["а) совокупность воздействий отдельных частей системы на другие ее части;", "б) совокупность воздействий окружающей среды на систему и воздействий системы на окружающую среду."], "correct": "б"},
        {"question": "3. Что такое «система»?", "options": ["а) объект, процесс в котором участвующие элементы связаны некоторыми связями и отношениями;", "б) упорядоченное представление об объекте исследования с точки зрения поставленной цели;", "в) часть объективной реальности, ограниченная целью (целями) и ресурсами;", "г) множество элементов какой-либо природы."], "correct": "б"},
        {"question": "4. Укажите различия между подсистемой и надсистемой.", "options": ["а) никакого различия нет;", "б) подсистема располагается ниже системы, а надсистема выше;", "в) подсистема является частью данной системы, а надсистема это система, элементом которой является данная система."], "correct": "в"},
        {"question": "5. Что такое элемент системы?", "options": ["а) часть системы, не обладающая свойствами всей системы;", "б) объект, выполняющий определенные функции и не подлежащий дальнейшему разделению в рамках поставленной задачи;", "в) часть системы, не подлежащий членению в рамках рассматриваемой задачи."], "correct": "б"},
        {"question": "6. Что необходимо для выделения системы?", "options": ["а) объект исследования;", "б) цель, для реализации которой формируется система;", "в) субъект наблюдения;", "г) надсистема."], "correct": "б"},
        {"question": "7. Что такое подсистема?", "options": ["а) некоторая часть элементов данной системы;", "б) система, являющаяся составной частью данной системы;", "в) часть системы с некоторыми связями и отношениями."], "correct": "б"},
        {"question": "8. Что означает свойство эмерджентности системы?", "options": ["а) целостность системы;", "б) несводимость свойств системы к сумме свойств ее отдельных частей."], "correct": "б"},
        {"question": "9. По каким признакам классифицируются системы?", "options": ["а) по происхождению;", "б) по длительности существования;", "в) по объективности существования."], "correct": "в"},
        {"question": "10. Какие системы называются сложными?", "options": ["а) сложными называются системы с большим числом элементов;", "б) система называется сложной, если в ней не хватает ресурсов;", "в) система называется сложной, если неизвестны законы ее функционирования."], "correct": "в"},
        {"question": "11. Что такое классификация?", "options": ["а) разделение элементов множества на отдельные подмножества;", "б) разделение совокупности объектов на классы по некоторым наиболее существенным признакам."], "correct": "б"},
        {"question": "12. На какие группы можно разбить все системы по объективности существования?", "options": ["а) большие и сложные;", "б) реальные и абстрактные;", "в) физические и символические."], "correct": "б"},
        {"question": "13. На какие группы делятся системы в зависимости от происхождения?", "options": ["а) живые и неживые;", "б) материальные и знаковые;", "в) естественные и искусственные."], "correct": "в"},
        {"question": "14. На какие группы делятся системы по отношению к окружающей среде?", "options": ["а) открытые и закрытые;", "б) естественные и искусственные;", "в) материальные и абстрактные."], "correct": "а"},
        {"question": "15. Какие системы называются централизованными?", "options": ["а) имеющие в своем составе элемент, играющий доминирующую роль в функционировании системы;", "б) имеющие в своем составе несколько элементов, играющих главную роль в функционировании системы;", "в) не имеющие в своем составе элемент, играющий главную, доминирующую роль в функционировании системы."], "correct": "а"},
        {"question": "16. Какие системы называются одномерными?", "options": ["а) имеющие один вход и несколько выходов;", "б) имеющие один вход и один выход;", "в) имеющие несколько входов и один выход."], "correct": "б"},
        {"question": "17. Какие системы называются многомерными?", "options": ["а) системы, у которых входов и выходов больше одного;", "б) системы, у которых входов или выходов больше одного;", "в) системы, у которых один вход и один выход."], "correct": "а"},
        {"question": "18. Какие системы называются гомогенными?", "options": ["а) системы с однородными элементами;", "б) системы с разнородными элементами."], "correct": "а"},
        {"question": "19. Какие системы называются казуальными?", "options": ["а) системы, способные ставить себе цель;", "б) системы неспособные ставить себе цель."], "correct": "б"},
        {"question": "20. По какому признаку различают детерминированные и стохастические системы?", "options": ["а) по предсказуемости значений выходных переменных от значений других выходных переменных;", "б) по предсказуемости значений выходных переменных системы при известных значениях входных."], "correct": "б"},
        {"question": "21. Можно ли отнести бухгалтерию к целенаправленным системам?", "options": ["а) можно;", "б) нельзя;", "в) не знаю."], "correct": "а"},
        {"question": "22. По типу описания закона (законов) функционирования системы могут быть:", "options": ["а) типа - черный ящик;", "б) типа - белый ящик;", "в) типа - красный ящик."], "correct": "б"},
        {"question": "23. Чем различаются цель-результат и цель-направление?", "options": ["а) ничем не различаются;", "б) цель-результат - конкретная, измеримая цель; цель-направление - идеальная, качественная цель;", "в) цель-результат имеет количественную характеристику, а цель-направление имеет качественную характеристику."], "correct": "б"},
        {"question": "24. Что такое цель?", "options": ["а) образ несуществующего и не желаемого - с точки зрения задачи или рассматриваемой проблемы - состояния системы, т.е. такого состояния, которое не позволяет решать проблему при данных ресурсах;", "б) образ существующего, но не желаемого - с точки зрения задачи или рассматриваемой проблемы - состояния системы, т.е. такого состояния, которое не позволяет решать проблему при данных ресурсах;", "в) субъективный образ несуществующего, но желаемого - с точки зрения задачи или рассматриваемой проблемы - состояния системы."], "correct": "в"},
        {"question": "25. Что такое «дерево целей» объекта?", "options": ["а) метод целеуточнения, позволяющий не распределить сложные задачи по их важности, используя иерархическую структуру;", "б) метод целеполагания, позволяющий распределить сложные задачи по их важности, используя иерархическую структуру."], "correct": "б"},
        {"question": "26. Что такое «дерево решений»?", "options": ["а) метод ручного обучения, который используют, чтобы разделить небольшой объём входных данных на относительно небольшие группы и прогнозировать наступление события в зависимости от определённых условий;", "б) метод машинного обучения, который используют, чтобы разделить большой объём входных данных на относительно небольшие группы и прогнозировать наступление события в зависимости от определённых условий."], "correct": "б"},
        {"question": "27. Что понимается в системном анализе под целью с позиции субъекта?", "options": ["а) цель с позиции субъекта определяет цель анализа, описание, проектирование (создание или реорганизация) и управление;", "б) цель с позиции субъекта определяет цель его функционирования (существования), которое может быть заложено при его создании, либо функционировать внутри его."], "correct": "а"},
        {"question": "28. Что такое прямая связь?", "options": ["а) связь элементов системы с окружающей средой;", "б) связь между выходом одного элемента и входом другого;", "в) связь между выходом и входом одного и того же элемента."], "correct": "б"},
        {"question": "29. Что такое структура системы?", "options": ["а) устойчивая упорядоченность в пространстве элементов системы и связей между ними;", "б) устойчивая упорядоченность в пространстве и во времени элементов системы и связей между ними;", "в) устойчивая упорядоченность во времени элементов системы и связей между ними."], "correct": "б"},
        {"question": "30. Какие виды структур систем вы знаете?", "options": ["а) линейная;", "б) нелинейная;", "в) односвязная;", "г) многосвязная."], "correct": "а"},
        {"question": "31. В чем суть метода «черный ящик»?", "options": ["а) в проверке работы системы только с определением её элементного состава;", "б) в проверке работы системы без глубокого знания её внутренних механизмов;", "в) в проверке работы системы с определением её состава подсистем."], "correct": "б"},
        {"question": "32. В чем суть метода «белый ящик»?", "options": ["а) в проверке работы системы с определением её элементного состава;", "б) в проверке работы системы без глубокого знания её внутренних механизмов;", "в) в проверке работы системы с определением её совокупности элементов и отношений между ними."], "correct": "в"},
        {"question": "33. Что собой представляет модель «черного ящика»?", "options": ["а) модель, описывающая элементный состав системы, но не раскрывающая их взаимосвязи;", "б) модель, не раскрывающая внутренней структуры, внутреннего представления системы;", "в) модель, раскрывающая внутреннюю структуру, внутреннее представление системы."], "correct": "б"},
        {"question": "34. Что собой представляет модель структуры системы?", "options": ["а) модель, описывающая элементный состав системы, но не раскрывающая их взаимосвязи;", "б) модель, не раскрывающая внутренней структуры, внутреннего представления системы;", "в) модель, характеризующая состав системы, отражающая взаимосвязи между объектами системы."], "correct": "в"},
        {"question": "35. Что собой представляет модель «белого ящика»?", "options": ["а) модель, описывающая элементный состав системы, но не раскрывающая их взаимосвязи;", "б) модель, характеризующая состав системы, отражающая взаимосвязи между объектами системы;", "в) модель, описывающая все процессы, происходящие в системе, а также входы и выходы системы."], "correct": "в"},
        {"question": "36. Что представляют собой динамические модели систем?", "options": ["а) модель, характеризующая состав системы, отражающая взаимосвязи между объектами системы;", "б) модели, описывающие поведение систем, происходящие с течением времени в них изменения, последовательность операций, действий, причинно-следственные связи;", "в) модель, описывающая элементный состав системы, но не раскрывающая их взаимосвязи."], "correct": "б"},
        {"question": "37. Что такое модель системы?", "options": ["а) упрощенный образ исследуемой системы, обладающий ее основными характеристиками с точки зрения цели исследования;", "б) некий объект-заместитель, который в определенных условиях может заменить объект-оригинал, воспроизводя интересующие нас свойства и характеристики оригинала, причем имеет существенные преимущества и удобства;", "в) это описание системы как единого целого, обладающего свойством эмерджентности."], "correct": "а"},
        {"question": "38. Какие методы относятся к методам формализованного представления систем?", "options": ["а) аналитические и статистические методы;", "б) разработки сценариев;", "в) графические методы;", "г) экспертных оценок."], "correct": "а"},
        {"question": "39. Какие методы относятся к методам качественного описания систем?", "options": ["а) аналитические и статистические методы;", "б) разработки сценариев;", "в) графические методы;", "г) экспертных оценок."], "correct": "г"},
        {"question": "40. Совокупность всех объектов, изменение свойств которых влияет на системы, а также тех объектов, чьи свойства меняются в результате поведения системы, это:", "options": ["а) подсистемы;", "б) окружающая среда;", "в) компоненты."], "correct": "б"},
        {"question": "41. Сетевая структура представляет собой:", "options": ["а) декомпозицию системы во времени;", "б) декомпозицию системы в пространстве;", "в) относительно независимые, взаимодействующие между собой подсистемы."], "correct": "в"},
        {"question": "42. Объединение некоторых параметров системы в параметре более высокого уровня - это:", "options": ["а) декомпозиция;", "б) агрегирование;", "в) синергия."], "correct": "б"},
        {"question": "43. Уровень иерархической структуры, при которой система представлена в виде взаимодействующих подсистем называется:", "options": ["а) слоем;", "б) стратой;", "в) эшелоном."], "correct": "б"},
        {"question": "44. Что такое граница системы?", "options": ["а) произвольная линия, разделяющая подсистемы системы;", "б) разграничение между системой и окружающей средой, через которое осуществляется обмен материалами и энергией;", "в) область, где происходит наибольшая активность системы."], "correct": "б"},
        {"question": "45. Поясните суть метода «мозгового штурма».", "options": ["а) суть метода «мозгового штурма» заключается в поиске решений задачи субъектом создавшим систему;", "б) суть метода «мозгового штурма» заключается в коллективном поиске решений задачи;", "в) суть метода «мозгового штурма» заключается в запутывании коллектива экспертов при поиске ими решений задачи."], "correct": "б"},
        {"question": "46. Поясните суть метода разработки сценариев.", "options": ["а) это метод, предполагающий описание последовательного развития событий (мероприятий), с увязкой по ресурсам;", "б) это метод подготовки представления о проблеме или объекте, изложенный в письменном виде, при этом сценарий предусматривает не только содержательные рассуждения, но и включает результаты количественного анализа;", "в) это метод, предполагающий описание случайного развития событий (мероприятий), с увязкой по ресурсам."], "correct": "б"},
        {"question": "47. Поясните суть метода «Дельфи».", "options": ["а) суть метода заключается в сборе независимых экспертных мнений по поставленной проблеме, что позволяет получить объективную оценку и принять правильное решение;", "б) метод предполагает применение прямых коллективных суждений и выработку на их основе рекомендаций по решению проблемы;", "в) метод предполагает использование экспертных оценок, так как предполагается, что мнение нескольких экспертов надежнее, чем одного."], "correct": "а"},
        {"question": "48. В чем заключаются основные особенности метода «Дельфи».", "options": ["а) анонимность;", "б) заочность;", "в) поэтапность;", "г) коллективность."], "correct": "а"},
        {"question": "49. В чем суть морфологических методов?", "options": ["а) суть морфологических методов заключается в систематическом нахождении небольшого числа, а точнее отдельных вариантов решения поставленной проблемы или реализации системы;", "б) суть морфологических методов заключается в систематическом нахождении наибольшего числа, а в пределе - всех возможных вариантов решения поставленной проблемы или реализации системы;", "в) суть морфологических методов заключается в случайном нахождении наибольшего числа, а в отдельных случаях - всех возможных вариантов решения поставленной проблемы или реализации системы."], "correct": "б"},
        {"question": "50. Что за научная дисциплина системный анализ?", "options": ["а) системный анализ -- научная дисциплина, разрабатывающая частные принципы исследования сложных объектов с учетом их системного характера;", "б) системный анализ -- научная дисциплина, разрабатывающая общие принципы исследования сложных объектов без учета их системного характера;", "в) системный анализ -- научная дисциплина, разрабатывающая общие принципы исследования сложных объектов с учетом их системного характера."], "correct": "в"},
        {"question": "51. В чем отличие общего и канонического вида линейной модели?", "options": ["1) Каноническая форма модели содержит только ограничения типа «≥»;", "2) Каноническая форма модели содержит только ограничения типа «≤»;", "3) нет правильного ответа;", "4) Каноническая форма модели содержит только ограничения типа строгое равенство."], "correct": "4"},
        {"question": "52. Как выбирается разрешающий столбец при решении задачи симплексным методом на максимум?", "options": ["1) В строке целевой функции выбирается наибольший положительный коэффициент;", "2) В строке целевой функции выбирается наибольший по модулю отрицательный коэффициент;", "3) В строке целевой функции выбирается наименьший по модулю коэффициент;", "4) Нет правильного ответа."], "correct": "1"},
        {"question": "53. Сколько занятых клеток должно быть в таблице транспортной задачи при расчете потенциалов?", "options": ["1) m;", "2) n−m;", "3) m+n+1;", "4) m+n−1."], "correct": "4"},
        {"question": "54. Что является показателем достижения максимума при решении задачи симплексным методом?", "options": ["1) Нет правильного ответа;", "2) Отсутствие положительных коэффициентов в строке целевой функции симплексной таблицы;", "3) Отсутствие отрицательных коэффициентов в строке целевой функции симплексной таблицы;", "4) Нулевая строка целевой функции."], "correct": "2"},
        {"question": "55. Что является показателем достижения минимума при решении задачи симплексным методом?", "options": ["1) Нет правильного ответа;", "2) Отсутствие положительных коэффициентов в строке целевой функции симплексной таблицы;", "3) Отсутствие отрицательных коэффициентов в строке целевой функции симплексной таблицы;", "4) Нулевая строка целевой функции."], "correct": "3"},
        {"question": "56. Как выбирается разрешающая строка?", "options": ["1) Среди отношений свободных членов к положительным элементам разрешающего столбца выбирается наименьшее;", "2) Среди отношений свободных членов к положительным элементам разрешающего столбца выбирается наибольшее;", "3) Среди отношений свободных членов к элементам разрешающего столбца выбирается наибольшее по модулю;", "4) Нет правильного ответа."], "correct": "1"},
        {"question": "57. Как проверить правильность решения задачи, решенной симплексным методом?", "options": ["1) Подстановкой оптимальных значений переменных в каноническую форму модели;", "2) По значению целевой функции;", "3) Нет правильного ответа;", "4) По правилу «прямоугольника»."], "correct": "1"},
        {"question": "58. В каких случаях при решении линейных задач применяют искусственные переменные?", "options": ["1) Если система ограничений модели содержит ограничения типа «≤»;", "2) Если система ограничений модели содержит ограничения типа «≥»;", "3) Нет правильного ответа;", "4) Если задача решается на максимум."], "correct": "2"},
        {"question": "59. Даны функции спроса D(p) и предложения S(p), где р - цена товара. Тогда равновесная цена равна...", "options": ["1) 0,5;", "2) 1;", "3) 3;", "4) -0,5."], "correct": "3"},
        {"question": "60. Даны функции спроса D(p) и предложения S(p), где р - цена товара. Тогда равновесный объем равен...", "options": ["1) -3;", "2) 1;", "3) 5,5;", "4) 3."], "correct": "4"},
        {"question": "61. Даны функции спроса D(p) и предложения S(p), где р - цена товара. Тогда равновесная цена равна...", "options": ["1) 2/9;", "2) 3;", "3) 5/3;", "4) 1."], "correct": "3"},
        {"question": "62. Даны функции спроса D(p) и предложения S(p), где р - цена товара. Тогда равновесный объём равен...", "options": ["1) 2/9;", "2) 3;", "3) 5/3;", "4) 1."], "correct": "4"},
        {"question": "63. Даны функции спроса D(p) и предложения S(p), где р - цена товара. Тогда равновесная цена равна...", "options": ["1) 2,5;", "2) 3,5;", "3) 10,5;", "4) -1."], "correct": "2"},
        {"question": "64. Даны функции спроса D(p) и предложения S(p), где р - цена товара. Тогда равновесный объём равен...", "options": ["1) 3,5;", "2) 10,5;", "3) 2,5;", "4) -2."], "correct": "1"},
        {"question": "65. Даны функции спроса D(p) и предложения S(p), где р - цена товара. Тогда равновесная цена равна...", "options": ["1) 7,6;", "2) 1,2;", "3) 5;", "4) 1."], "correct": "3"},
        {"question": "66. Даны функции спроса D(p) и предложения S(p), где р - цена товара. Тогда равновесный объём равен...", "options": ["1) 7,6;", "2) 1,2;", "3) 5;", "4) 1."], "correct": "4"},
        {"question": "67. Даны функции спроса D(p) и предложения S(p), где р - цена товара. Тогда равновесная цена равна...", "options": ["1) 2,2;", "2) 5,4;", "3) 10;", "4) 1."], "correct": "3"},
        {"question": "68. Даны функции спроса D(p) и предложения S(p), где р - цена товара. Тогда равновесный объём равен...", "options": ["1) 10;", "2) 5,4;", "3) 2,2;", "4) 1."], "correct": "1"},
        {"question": "69. Даны функции спроса D(p) и предложения S(p), где р - цена товара. Тогда равновесная цена равна...", "options": ["1) 4;", "2) 1/2;", "3) 2,5;", "4) 3/4."], "correct": "3"},
        {"question": "70. Даны функции спроса D(p) и предложения S(p), где р - цена товара. Тогда равновесный объём равен...", "options": ["1) 3/4;", "2) 4;", "3) 2,5;", "4) 0,5."], "correct": "2"},
        {"question": "71. Даны функции спроса D(p) и предложения S(p), где р - цена товара. Тогда равновесная цена равна...", "options": ["1) -2;", "2) 2;", "3) 3;", "4) 4."], "correct": "2"},
        {"question": "72. Даны функции спроса D(p) и предложения S(p), где р - цена товара. Тогда равновесная объём равна...", "options": ["1) 1;", "2) 2;", "3) 3;", "4) 5."], "correct": "2"},
        {"question": "73. Переменная, относительно которой решено уравнение для формирования опорного плана, при решении задачи линейного программирования симплексным методом.", "options": ["1) Базисная переменная;", "2) Основная переменная;", "3) Зависимая переменная;", "4) Независимая переменная;", "5) Правильного ответа нет."], "correct": "1"},
        {"question": "74. Переменная, вводимая в неравенство с целью преобразования его в уравнение, при решении задачи линейного программирования симплексным методом.", "options": ["1) Основная переменная;", "2) Независимая переменная;", "3) Зависимая переменная;", "4) Искусственная переменная;", "5) Правильного ответа нет."], "correct": "4"},
        {"question": "75. Переменная, значение которой определяется на основе значения другой переменной. Например, переменная Y в выражении Y = F(X).", "options": ["1) Основная переменная;", "2) Дополнительная переменная;", "3) Искусственная переменная;", "4) Зависимая переменная;", "5) Правильного ответа нет."], "correct": "4"},
        {"question": "76. Переменная, значение которой требуется определить в процессе решения экономико-математической задачи, в соответствии с постановкой задачи.", "options": ["1) Основная переменная;", "2) Дополнительная переменная;", "3) Искусственная переменная;", "4) Целочисленная переменная;", "5) Правильного ответа нет."], "correct": "1"},
        {"question": "77. Симплексная таблица. Столбец, в индексной строке которого находится наибольший по абсолютному значению коэффициент переменной целевой функции.", "options": ["1) Столбец оценочных отношений;", "2) Столбец свободных членов;", "3) Разрешающий столбец;", "4) Столбец искусственных переменных;", "5) Правильного ответа нет."], "correct": "3"},
        {"question": "78. Симплексная таблица. Строка, в столбце оценочных отношений которой находится наименьший не отрицательный элемент.", "options": ["1) Базисная строка;", "2) Разрешающая строка;", "3) Индексная строка;", "4) Искусственная строка;", "5) Правильного ответа нет."], "correct": "2"},
        {"question": "79. Симплексная таблица. Элемент, находящийся на пересечении разрешающего столбца и разрешающей строки.", "options": ["1) Свободный член;", "2) Оценочное отношение;", "3) Коэффициент целевой функции;", "4) Оптимальная оценка;", "5) Правильного ответа нет."], "correct": "5"}
    ];

    // === ПЕРЕМЕННЫЕ ===
    let currentQuestions = [];
    let currentIndex = 0;
    let score = 0;
    let wrongCount = 0;
    let isQuestionLocked = false;
    const QUESTIONS_LIMIT = 40;

    // === ЭЛЕМЕНТЫ DOM ===
    const screens = {
        start: document.getElementById('start-screen'),
        quiz: document.getElementById('quiz-screen'),
        results: document.getElementById('results-screen')
    };
    
    const ui = {
        questionText: document.getElementById('question-text'),
        optionsContainer: document.getElementById('options-container'),
        counterText: document.getElementById('question-counter'),
        progressBar: document.getElementById('progress-bar'),
        nextBtn: document.getElementById('next-btn'),
        scoreDisplay: document.getElementById('score-display'),
        correctCount: document.getElementById('final-correct'),
        wrongCount: document.getElementById('final-wrong'),
        gradeBadge: document.getElementById('grade-badge'),
        feedbackText: document.getElementById('feedback-text'),
        liveCorrect: document.getElementById('live-correct'),
        liveWrong: document.getElementById('live-wrong')
    };

    function showScreen(screenName) {
        Object.values(screens).forEach(scr => scr.classList.remove('active'));
        screens[screenName].classList.add('active');
    }

    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }

    function startTest() {
        try {
            const shuffled = shuffleArray([...allQuestions]);
            currentQuestions = shuffled.slice(0, QUESTIONS_LIMIT);
            
            currentIndex = 0;
            score = 0;
            wrongCount = 0;
            
            updateLiveCounters();
            showScreen('quiz');
            loadQuestion();
        } catch (e) {
            alert("Ошибка: " + e.message);
        }
    }

    function updateLiveCounters() {
        ui.liveCorrect.innerText = score;
        ui.liveWrong.innerText = wrongCount;
    }

    function loadQuestion() {
        const q = currentQuestions[currentIndex];
        isQuestionLocked = false;
        
        ui.questionText.innerText = q.question;
        ui.counterText.innerText = `Вопрос ${currentIndex + 1} из ${QUESTIONS_LIMIT}`;
        
        const progress = (currentIndex / QUESTIONS_LIMIT) * 100;
        ui.progressBar.style.width = `${progress}%`;

        ui.optionsContainer.innerHTML = '';
        ui.nextBtn.disabled = true;
        ui.nextBtn.innerText = "След. вопрос";

        q.options.forEach((opt) => {
            const btn = document.createElement('div');
            btn.className = 'option-btn';
            btn.innerText = opt;
            
            // Получаем "чистое" значение (первая буква/цифра)
            const value = opt.trim().charAt(0).toLowerCase();
            
            // Сохраняем данные в атрибуты для поиска правильного ответа
            btn.dataset.value = value;
            
            btn.onclick = () => selectOption(btn, value, q.correct);
            ui.optionsContainer.appendChild(btn);
        });
    }

    function selectOption(btnElement, value, correctValue) {
        if (isQuestionLocked) return; // Защита от повторного клика
        isQuestionLocked = true;

        const isCorrect = value.toString() === correctValue.toString().toLowerCase();

        // Отмечаем выбранный
        if (isCorrect) {
            btnElement.classList.add('correct');
            score++;
        } else {
            btnElement.classList.add('wrong');
            wrongCount++;
            
            // Подсвечиваем правильный, если ошиблись
            const buttons = document.querySelectorAll('.option-btn');
            buttons.forEach(b => {
                if (b.dataset.value === correctValue.toString().toLowerCase()) {
                    b.classList.add('correct');
                }
            });
        }

        // Блокируем все кнопки
        const buttons = document.querySelectorAll('.option-btn');
        buttons.forEach(b => b.classList.add('disabled'));

        updateLiveCounters();
        ui.nextBtn.disabled = false;
    }

    function nextQuestion() {
        currentIndex++;

        if (currentIndex < QUESTIONS_LIMIT) {
            loadQuestion();
        } else {
            showResults();
        }
    }

    function showResults() {
        showScreen('results');

        const percentage = Math.round((score / QUESTIONS_LIMIT) * 100);
        ui.scoreDisplay.innerText = `${percentage}%`;
        ui.correctCount.innerText = score;
        ui.wrongCount.innerText = wrongCount;

        let grade = "2 (Неудовлетворительно)";
        let color = "#e74c3c"; 

        if (percentage >= 90) {
            grade = "5 (Отлично)";
            color = "#2ecc71";
        } else if (percentage >= 75) {
            grade = "4 (Хорошо)";
            color = "#3498db";
        } else if (percentage >= 60) {
            grade = "3 (Удовлетворительно)";
            color = "#f39c12";
        }

        ui.gradeBadge.innerText = grade;
        ui.gradeBadge.style.backgroundColor = color;
        ui.scoreDisplay.style.borderColor = color;
        ui.scoreDisplay.style.color = color;

        if (percentage >= 60) {
            ui.feedbackText.innerText = "Поздравляем! Вы успешно сдали тест.";
        } else {
            ui.feedbackText.innerText = "К сожалению, тест не сдан.";
        }
    }

    function restartTest() {
        startTest();
    }
</script>

</body>
</html>
